{% extends "base.html" %}
{% load static %}
{% block extra_title%}Cats{% endblock %}

<!-- Free Delivery Banner -->
{% block page_header %}
{% endblock %}

{% block content %}
<div class="container">
    <div class="white-overlay p1">
        <div class="row w-100">
            {% for cat in cats %}
                <div class="col s12 m6 l4 xl3 mt1">
                    <a href="{% url 'cat_detail' cat.id %}">
                        <div class="gallery-item">
                            <div class="square">
                                <div class="gallery-image content">
                                    {% if cat.image %}
                                        <img class="" src="{{ cat.image.url }}" alt="{{ cat.name }}">
                                    {% elif cat.image_url %}
                                        <img class="" src="{{ cat.image_url }}" alt="{{ cat.name }}">
                                    {% else %}
                                        <img class="" src="{{ MEDIA_URL }}noimage.png" alt="{{ cat.name }}">
                                    {% endif %}
                                </div>
                            </div>
                            <div class="cat-overlay cat-overlay-fade">
                                <div class="gallery-text">
                                    <h5 class="white-text">{{ cat.name }}</h5>
                                    <p class="xxl-only light small-font">{{ cat.sex }}</p>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                
            {% endfor %}
            
        </div>
    </div>
</div>
    
{% endblock %}

{% block postloadjs %}
    {{ block.super}}
    <script>
        $('#sort-selector').change(function() {
            var selector = $(this)
            var currentUrl = new URL(window.location);
    
            var selectedVal = selector.val();
            if(selectedVal != 'reset'){
                var sort = selectedVal.split('_')[0];
                var direction = selectedVal.split('_')[1];
    
                currentUrl.searchParams.set('sort', sort);
                currentUrl.searchParams.set('direction', direction);
    
                window.location.replace(currentUrl);
            } else {
                currentUrl.searchParams.delete('sort');
                currentUrl.searchParams.delete('direction');
    
                window.location.replace(currentUrl);
            }
        })
    </script>
{% endblock %}